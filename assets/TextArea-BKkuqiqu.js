import{r as i,d as me,f as H,R as y,i as ze,m as ve,e as ye,l as $e}from"./index-CXsAr4fj.js";import{u as Ae,B as Ce,r as xe,g as Ie}from"./getAllowClear-3MJ9G9_L.js";import{d as be,p as Re,w as he,D as Ee,F as Te,q as He,f as Ve,r as Me,n as Pe,s as Fe,v as Oe,x as De}from"./focus-CQ_iPNPW.js";import{i as Le,a as je,u as _e}from"./index-NFi46t9H.js";const We=`
  min-height:0 !important;
  max-height:none !important;
  height:0 !important;
  visibility:hidden !important;
  overflow:hidden !important;
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
  pointer-events: none !important;
`,Ne=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","font-variant","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing","word-break","white-space"],ue={};let x;function qe(e,t=!1){const r=e.getAttribute("id")||e.getAttribute("data-reactid")||e.getAttribute("name");if(t&&ue[r])return ue[r];const a=window.getComputedStyle(e),m=a.getPropertyValue("box-sizing")||a.getPropertyValue("-moz-box-sizing")||a.getPropertyValue("-webkit-box-sizing"),s=parseFloat(a.getPropertyValue("padding-bottom"))+parseFloat(a.getPropertyValue("padding-top")),c=parseFloat(a.getPropertyValue("border-bottom-width"))+parseFloat(a.getPropertyValue("border-top-width")),u={sizingStyle:Ne.map(l=>`${l}:${a.getPropertyValue(l)}`).join(";"),paddingSize:s,borderSize:c,boxSizing:m};return t&&r&&(ue[r]=u),u}function Ye(e,t=!1,r=null,a=null){x||(x=document.createElement("textarea"),x.setAttribute("tab-index","-1"),x.setAttribute("aria-hidden","true"),x.setAttribute("name","hiddenTextarea"),document.body.appendChild(x)),e.getAttribute("wrap")?x.setAttribute("wrap",e.getAttribute("wrap")):x.removeAttribute("wrap");const{paddingSize:m,borderSize:s,boxSizing:c,sizingStyle:$}=qe(e,t);x.setAttribute("style",`${$};${We}`),x.value=e.value||e.placeholder||"";let u,l,p,g=x.scrollHeight;if(c==="border-box"?g+=s:c==="content-box"&&(g-=m),r!==null||a!==null){x.value=" ";const V=x.scrollHeight-m;r!==null&&(u=V*r,c==="border-box"&&(u=u+m+s),g=Math.max(u,g)),a!==null&&(l=V*a,c==="border-box"&&(l=l+m+s),p=g>l?"":"hidden",g=Math.min(l,g))}const I={height:g,overflowY:p,resize:"none"};return u&&(I.minHeight=u),l&&(I.maxHeight=l),I}function pe(){return pe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},pe.apply(this,arguments)}const ce=0,fe=1,de=2,Ze=i.forwardRef((e,t)=>{const{prefixCls:r,defaultValue:a,value:m,autoSize:s,onResize:c,className:$,style:u,disabled:l,onChange:p,onInternalAutoSize:g,...I}=e,[V,R]=be(a,m),A=V??"",F=h=>{R(h.target.value),p==null||p(h)},f=i.useRef();i.useImperativeHandle(t,()=>({textArea:f.current}));const[S,E]=i.useMemo(()=>s&&typeof s=="object"?[s.minRows,s.maxRows]:[],[s]),O=!!s,[w,M]=i.useState(de),[q,D]=i.useState(),Y=()=>{M(ce)};me(()=>{O&&Y()},[m,S,E,O]),me(()=>{if(w===ce)M(fe);else if(w===fe){const h=Ye(f.current,!1,S,E);M(de),D(h)}},[w]);const Z=i.useRef(),P=()=>{he.cancel(Z.current)},G=h=>{w===de&&(c==null||c(h),s&&(P(),Z.current=he(()=>{Y()})))};i.useEffect(()=>P,[]);const L={...u,...O?q:null};return(w===ce||w===fe)&&(L.overflowY="hidden",L.overflowX="hidden"),i.createElement(Re,{onResize:G,disabled:!(s||c)},i.createElement("textarea",pe({},I,{ref:f,style:L,className:H(r,$,{[`${r}-disabled`]:l}),disabled:l,value:A,onChange:F})))});function ge(){return ge=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ge.apply(this,arguments)}const Ge=y.forwardRef(({defaultValue:e,value:t,onFocus:r,onBlur:a,onChange:m,allowClear:s,maxLength:c,onCompositionStart:$,onCompositionEnd:u,suffix:l,prefixCls:p="rc-textarea",showCount:g,count:I,className:V,style:R,disabled:A,hidden:F,classNames:f,styles:S,onResize:E,onClear:O,onPressEnter:w,readOnly:M,autoSize:q,onKeyDown:D,...Y},Z)=>{const[P,G]=be(e,t),X=P==null?"":String(P),[L,h]=y.useState(!1),j=y.useRef(!1),[K,_]=y.useState(null),o=i.useRef(null),B=i.useRef(null),z=()=>{var n;return(n=B.current)==null?void 0:n.textArea},k=()=>{z().focus()};i.useImperativeHandle(Z,()=>{var n;return{resizableTextArea:B.current,focus:k,blur:()=>{z().blur()},nativeElement:((n=o.current)==null?void 0:n.nativeElement)||z()}}),i.useEffect(()=>{h(n=>!A&&n)},[A]);const[U,ne]=y.useState(null);y.useEffect(()=>{U&&z().setSelectionRange(...U)},[U]);const d=Ae(I,g),W=d.max??c,re=Number(W)>0,J=d.strategy(X),ee=!!W&&J>W,Q=(n,N)=>{let ae=N;!j.current&&d.exceedFormatter&&d.max&&d.strategy(N)>d.max&&(ae=d.exceedFormatter(N,{max:d.max}),N!==ae&&ne([z().selectionStart||0,z().selectionEnd||0])),G(ae),xe(n.currentTarget,n,m,ae)},ie=n=>{j.current=!0,$==null||$(n)},se=n=>{j.current=!1,Q(n,n.currentTarget.value),u==null||u(n)},oe=n=>{Q(n,n.target.value)},le=n=>{n.key==="Enter"&&w&&!n.nativeEvent.isComposing&&w(n),D==null||D(n)},te=n=>{h(!0),r==null||r(n)},C=n=>{h(!1),a==null||a(n)},b=n=>{G(""),k(),xe(z(),n,m)};let T=l,v;d.show&&(d.showFormatter?v=d.showFormatter({value:X,count:J,maxLength:W}):v=`${J}${re?` / ${W}`:""}`,T=y.createElement(y.Fragment,null,T,y.createElement("span",{className:H(`${p}-data-count`,f==null?void 0:f.count),style:S==null?void 0:S.count},v)));const Se=n=>{var N;E==null||E(n),(N=z())!=null&&N.style.height&&_(!0)},we=!q&&!g&&!s;return y.createElement(Ce,{ref:o,value:X,allowClear:s,handleReset:b,suffix:T,prefixCls:p,classNames:{...f,affixWrapper:H(f==null?void 0:f.affixWrapper,{[`${p}-show-count`]:g,[`${p}-textarea-allow-clear`]:s})},disabled:A,focused:L,className:H(V,ee&&`${p}-out-of-range`),style:{...R,...K&&!we?{height:"auto"}:{}},dataAttrs:{affixWrapper:{"data-count":typeof v=="string"?v:void 0}},hidden:F,readOnly:M,onClear:O},y.createElement(Ze,ge({},Y,{autoSize:q,maxLength:c,onKeyDown:le,onChange:oe,onFocus:te,onBlur:C,onCompositionStart:ie,onCompositionEnd:se,className:H(f==null?void 0:f.textarea),style:{resize:R==null?void 0:R.resize,...S==null?void 0:S.textarea},disabled:A,prefixCls:p,onResize:Se,ref:B,readOnly:M})))}),Xe=e=>{const{componentCls:t,paddingLG:r}=e,a=`${t}-textarea`;return{[`textarea${t}`]:{maxWidth:"100%",height:"auto",minHeight:e.controlHeight,lineHeight:e.lineHeight,verticalAlign:"bottom",transition:`all ${e.motionDurationSlow}`,resize:"vertical",[`&${t}-mouse-active`]:{transition:`all ${e.motionDurationSlow}, height 0s, width 0s`}},[`${t}-textarea-affix-wrapper-resize-dirty`]:{width:"auto"},[a]:{position:"relative","&-show-count":{[`${t}-data-count`]:{position:"absolute",bottom:e.calc(e.fontSize).mul(e.lineHeight).mul(-1).equal(),insetInlineEnd:0,color:e.colorTextDescription,whiteSpace:"nowrap",pointerEvents:"none"}},[`
        &-allow-clear > ${t},
        &-affix-wrapper${a}-has-feedback ${t}
      `]:{paddingInlineEnd:r},[`&-affix-wrapper${t}-affix-wrapper`]:{padding:0,[`> textarea${t}`]:{fontSize:"inherit",border:"none",outline:"none",background:"transparent",minHeight:e.calc(e.controlHeight).sub(e.calc(e.lineWidth).mul(2)).equal(),"&:focus":{boxShadow:"none !important"}},[`${t}-suffix`]:{margin:0,"> *:not(:last-child)":{marginInline:0},[`${t}-clear-icon`]:{position:"absolute",insetInlineEnd:e.paddingInline,insetBlockStart:e.paddingXS},[`${a}-suffix`]:{position:"absolute",top:0,insetInlineEnd:e.paddingInline,bottom:0,zIndex:1,display:"inline-flex",alignItems:"center",margin:"auto",pointerEvents:"none"}}},[`&-affix-wrapper${t}-affix-wrapper-rtl`]:{[`${t}-suffix`]:{[`${t}-data-count`]:{direction:"ltr",insetInlineStart:0}}},[`&-affix-wrapper${t}-affix-wrapper-sm`]:{[`${t}-suffix`]:{[`${t}-clear-icon`]:{insetInlineEnd:e.paddingInlineSM}}}}}},Be=ze(["Input","TextArea"],e=>{const t=ve(e,Le(e));return Xe(t)},je,{resetFont:!1}),ke=i.forwardRef((e,t)=>{var te;const{prefixCls:r,bordered:a=!0,size:m,disabled:s,status:c,allowClear:$,classNames:u,rootClassName:l,className:p,style:g,styles:I,variant:V,showCount:R,onMouseDown:A,onResize:F,...f}=e,{getPrefixCls:S,direction:E,allowClear:O,autoComplete:w,className:M,style:q,classNames:D,styles:Y}=ye("textArea"),Z=i.useContext(Ee),P=s??Z,{status:G,hasFeedback:X,feedbackIcon:L}=i.useContext(Te),h=De(G,c),[j,K]=$e([D,u],[Y,I],{props:e}),_=i.useRef(null);i.useImperativeHandle(t,()=>{var C;return{resizableTextArea:(C=_.current)==null?void 0:C.resizableTextArea,focus:b=>{var T,v;He((v=(T=_.current)==null?void 0:T.resizableTextArea)==null?void 0:v.textArea,b)},blur:()=>{var b;return(b=_.current)==null?void 0:b.blur()}}});const o=S("input",r),B=Ve(o),[z,k]=_e(o,l);Be(o,B);const{compactSize:U,compactItemClassnames:ne}=Me(o,E),d=Pe(C=>m??U??C),[W,re]=Fe("textArea",V,a),J=Ie($??O),[ee,Q]=i.useState(!1),[ie,se]=i.useState(!1),oe=C=>{Q(!0),A==null||A(C);const b=()=>{Q(!1),document.removeEventListener("mouseup",b)};document.addEventListener("mouseup",b)},le=C=>{var b,T;if(F==null||F(C),ee&&typeof getComputedStyle=="function"){const v=(T=(b=_.current)==null?void 0:b.nativeElement)==null?void 0:T.querySelector("textarea");v&&getComputedStyle(v).resize==="both"&&se(!0)}};return i.createElement(Ge,{autoComplete:w,...f,style:{...K.root,...q,...g},styles:K,disabled:P,allowClear:J,className:H(k,B,p,l,ne,M,j.root,{[`${o}-textarea-affix-wrapper-resize-dirty`]:ie}),classNames:{...j,textarea:H({[`${o}-sm`]:d==="small",[`${o}-lg`]:d==="large"},z,j.textarea,ee&&`${o}-mouse-active`),variant:H({[`${o}-${W}`]:re},Oe(o,h)),affixWrapper:H(`${o}-textarea-affix-wrapper`,{[`${o}-affix-wrapper-rtl`]:E==="rtl",[`${o}-affix-wrapper-sm`]:d==="small",[`${o}-affix-wrapper-lg`]:d==="large",[`${o}-textarea-show-count`]:R||((te=e.count)==null?void 0:te.show)},z)},prefixCls:o,suffix:X&&i.createElement("span",{className:`${o}-textarea-suffix`},L),showCount:R,ref:_,onResize:le,onMouseDown:oe})});export{ke as T};
