import{r as e,i as re,m as ne,o as se,k as ae,e as ie,f as w,C as ce,n as le}from"./index-CXsAr4fj.js";import{m as pe,n as me,f as q,p as ge,t as ue}from"./focus-CQ_iPNPW.js";import{u as de,r as fe}from"./useBreakpoint-BxZNTAN3.js";import{P as Se}from"./index-CBykjd2w.js";const O=e.createContext({}),he=o=>{const{antCls:r,componentCls:n,iconCls:s,avatarBg:i,avatarColor:c,containerSize:h,containerSizeLG:l,containerSizeSM:b,textFontSize:v,textFontSizeLG:C,textFontSizeSM:G,iconFontSize:L,iconFontSizeLG:z,iconFontSizeSM:t,borderRadius:g,borderRadiusLG:f,borderRadiusSM:R,lineWidth:F,lineType:N}=o,y=(S,u,x,$)=>({width:S,height:S,borderRadius:"50%",fontSize:u,[`&${n}-square`]:{borderRadius:$},[`&${n}-icon`]:{fontSize:x,[`> ${s}`]:{margin:0}}});return{[n]:{...ae(o),position:"relative",display:"inline-flex",justifyContent:"center",alignItems:"center",overflow:"hidden",color:c,whiteSpace:"nowrap",textAlign:"center",verticalAlign:"middle",background:i,border:`${se(F)} ${N} transparent`,"&-image":{background:"transparent"},[`${r}-image-img`]:{display:"block"},...y(h,v,L,g),"&-lg":{...y(l,C,z,f)},"&-sm":{...y(b,G,t,R)},"> img":{display:"block",width:"100%",height:"100%",objectFit:"cover"}}}},ve=o=>{const{componentCls:r,groupBorderColor:n,groupOverlapping:s,groupSpace:i}=o;return{[`${r}-group`]:{display:"inline-flex",[r]:{borderColor:n},"> *:not(:first-child)":{marginInlineStart:s}},[`${r}-group-popover`]:{[`${r} + ${r}`]:{marginInlineStart:i}}}},Ce=o=>{const{controlHeight:r,controlHeightLG:n,controlHeightSM:s,fontSize:i,fontSizeLG:c,fontSizeXL:h,fontSizeHeading3:l,marginXS:b,marginXXS:v,colorBorderBg:C}=o;return{containerSize:r,containerSizeLG:n,containerSizeSM:s,textFontSize:i,textFontSizeLG:i,textFontSizeSM:i,iconFontSize:Math.round((c+h)/2),iconFontSizeLG:l,iconFontSizeSM:i,groupSpace:v,groupOverlapping:-b,groupBorderColor:C}},D=re("Avatar",o=>{const{colorTextLightSolid:r,colorTextPlaceholder:n}=o,s=ne(o,{avatarBg:n,avatarColor:r});return[he(s),ve(s)]},Ce),J=e.forwardRef((o,r)=>{const{prefixCls:n,shape:s,size:i,src:c,srcSet:h,icon:l,className:b,rootClassName:v,style:C,alt:G,draggable:L,children:z,crossOrigin:t,gap:g=4,onError:f,...R}=o,[F,N]=e.useState(1),[y,S]=e.useState(!1),[u,x]=e.useState(!0),$=e.useRef(null),P=e.useRef(null),I=pe(r,$),{getPrefixCls:k,className:A,style:B}=ie("avatar"),E=e.useContext(O),T=()=>{if(!P.current||!$.current)return;const a=P.current.offsetWidth,p=$.current.offsetWidth;a!==0&&p!==0&&g*2<p&&N(p-g*2<a?(p-g*2)/a:1)};e.useEffect(()=>{S(!0)},[]),e.useEffect(()=>{x(!0),N(1)},[c]),e.useEffect(T,[g]);const H=()=>{(f==null?void 0:f())!==!1&&x(!1)},m=me(a=>i??(E==null?void 0:E.size)??a??"default"),K=Object.keys(typeof m=="object"?m||{}:{}).some(a=>["xs","sm","md","lg","xl","xxl"].includes(a)),W=de(K),Q=e.useMemo(()=>{if(typeof m!="object")return{};const a=fe.find(oe=>W[oe]),p=m[a];return p?{width:p,height:p,fontSize:p&&(l||z)?p/2:18}:{}},[W,m,l,z]),d=k("avatar",n),j=q(d),[U,Y]=D(d,j),Z=w({[`${d}-lg`]:m==="large",[`${d}-sm`]:m==="small"}),V=e.isValidElement(c),_=s||(E==null?void 0:E.shape)||"circle",ee=w(d,Z,A,`${d}-${_}`,{[`${d}-image`]:V||c&&u,[`${d}-icon`]:!!l},Y,j,b,v,U),te=typeof m=="number"?{width:m,height:m,fontSize:l?m/2:18}:{};let M;if(typeof c=="string"&&u)M=e.createElement("img",{src:c,draggable:L,srcSet:h,onError:H,alt:G,crossOrigin:t});else if(V)M=c;else if(l)M=l;else if(y||F!==1){const a=`scale(${F})`,p={msTransform:a,WebkitTransform:a,transform:a};M=e.createElement(ge,{onResize:T},e.createElement("span",{className:`${d}-string`,ref:P,style:p},z))}else M=e.createElement("span",{className:`${d}-string`,style:{opacity:0},ref:P},z);return e.createElement("span",{...R,style:{...te,...Q,...B,...C},className:ee,ref:I},M)}),X=o=>{const{size:r,shape:n}=e.useContext(O),s=e.useMemo(()=>({size:o.size||r,shape:o.shape||n}),[o.size,o.shape,r,n]);return e.createElement(O.Provider,{value:s},o.children)},ze=o=>{var $,P,I;const{getPrefixCls:r,direction:n}=e.useContext(ce),{prefixCls:s,className:i,rootClassName:c,style:h,maxCount:l,maxStyle:b,size:v,shape:C,maxPopoverPlacement:G,maxPopoverTrigger:L,children:z,max:t}=o,g=r("avatar",s),f=`${g}-group`,R=q(g),[F,N]=D(g,R),y=w(f,{[`${f}-rtl`]:n==="rtl"},N,R,i,c,F),S=ue(z).map((k,A)=>le(k,{key:`avatar-key-${A}`})),u=(t==null?void 0:t.count)||l,x=S.length;if(u&&u<x){const k=S.slice(0,u),A=S.slice(u,x),B=(t==null?void 0:t.style)||b,E=(($=t==null?void 0:t.popover)==null?void 0:$.trigger)||L||"hover",T=((P=t==null?void 0:t.popover)==null?void 0:P.placement)||G||"top",H={content:A,...t==null?void 0:t.popover,placement:T,trigger:E,rootClassName:w(`${f}-popover`,(I=t==null?void 0:t.popover)==null?void 0:I.rootClassName)};return k.push(e.createElement(Se,{key:"avatar-popover-key",destroyOnHidden:!0,...H},e.createElement(J,{style:B},`+${x-u}`))),e.createElement(X,{shape:C,size:v},e.createElement("div",{className:y,style:h},k))}return e.createElement(X,{shape:C,size:v},e.createElement("div",{className:y,style:h},S))},ye=J;ye.Group=ze;export{ye as A};
