import{S as E,r as m,j as e}from"./index-JgEZXFFe.js";import{u as W,a as A,N as I}from"./chunk-WWGJGFF6-DjkZ_t3b.js";import{l as O}from"./vi_VN-Cs_7G4UI.js";import{a as N}from"./index-4nCoxB4W.js";import{S as J}from"./SubHeader-DBitE5Ql.js";import{F as K}from"./Footer-qcRHcihJ.js";import{A as Q}from"./NavBar-DyiOIyIz.js";import{F as r}from"./index--TFoeH5B.js";import{u as U}from"./useTranslation-DRTFNy5h.js";import{C as X,F as k}from"./Table-AKCFBDqM.js";import{C as Z,B as h}from"./focus-BCInFMJ7.js";import{L}from"./index-Bqu70oAG.js";import{B as d}from"./Breadcrumb-B6q89ZIf.js";import{M as ee}from"./index-Ddo6FvDg.js";import{I as u}from"./index-DgM4qe6o.js";import{D as w}from"./index-BPoPmbFj.js";import{S as te}from"./index-CSBAjFoC.js";import{C as oe}from"./index-V3KQFUCC.js";import"./proxy-B8NW4Oew.js";import"./icon-logo-primary-wTGcesre.js";import"./useBreakpoint-DhZIo47Y.js";import"./index-RhAulSaI.js";import"./dropdown-BzKIIfrw.js";import"./PlusOutlined-C1rw31i6.js";import"./index-evwkGRXk.js";import"./getAllowClear-DSFRx4UW.js";import"./TextArea-Bm8ncQqU.js";import"./index-BU4LlcM-.js";const{Option:Te}=te,{Header:se,Content:ne,Footer:ae}=L,{Meta:Be}=oe,{RangePicker:Ve}=w,{Column:Ye,ColumnGroup:ze}=k;function $e(){const p=W(),G=p.pathname.split("/")[2],{search:t,setSearchList:M}=E(),[ie,x]=m.useState(!0),[_,f]=m.useState(!0),[F]=r.useForm(),[P]=r.useForm(),[j,y]=m.useState([]),H=A(),[c,b]=m.useState([]),[re,R]=m.useState(0),T=p.state.photos.length>0?p.state.photos[0]:"https://res.cloudinary.com/dggxjymsy/image/upload/v1667986972/pet88_upload/e10adb13acb1f3da8724a9149a58bd00_jwdh7h.jpg",{t:s,i18n:S}=U(),[B,g]=m.useState(!1);m.useEffect(()=>{C()},[t]);const V=async o=>{f(!0),await C(),M({...t,datesGrooming:o.datesGrooming||null})},Y=async o=>{const n=new Date(t==null?void 0:t.datesGrooming),i=new Date(moment(t==null?void 0:t.datesGrooming).add(1,"hours")),l=j.map(a=>a.roomNumbers.some(v=>c.some(q=>q.roomId===v._id))?Number(a.price):void 0).filter(a=>!!a).reduce((a,D)=>D+a,0);N.post("http://localhost:3001/api/order/grooming/booking",{email:o==null?void 0:o.email,name:(o==null?void 0:o.name)||"guest",phone:(o==null?void 0:o.phone)||"-1",roomList:c,photo:T,days:t.days,price:l,start:n,end:i,paymentMethod:"cash",service:t.services}).then(a=>{x(!1),H("/booking/success")}).catch(a=>console.log(a.message))},z=o=>{const n=o.target.checked,l=o.target.value.split("_");b(n?[...c,{roomId:l[0],price:l[1],roomNumber:l[2]}]:c.filter(a=>a.roomId!==l[0]))},C=async()=>{y([]);const o=new Date(t==null?void 0:t.datesGrooming).getTime(),n=new Date(moment(t==null?void 0:t.datesGrooming).add(2,"hours")).getTime();await N.post(`http://localhost:3001/api/hotel/availability/grooming/${G}`,{startDate:o,endDate:n}).then(i=>{R(0),b([]),y(i.data),x(!1),f(!1)}).catch(i=>console.log(i.message))},$=[{title:s("Name"),dataIndex:"title",sorter:(o,n)=>o.title.length-n.title.length},{title:s("Type"),dataIndex:"type"},{title:`${s("Service Price")}`,dataIndex:"price",render:o=>e.jsx("span",{children:` ${new Intl.NumberFormat("vi_VN",{style:"currency",currency:"VND"}).format(o)} / ${s("hour")}`}),sorter:(o,n)=>o.price-n.price},{title:s("Room"),dataIndex:"roomNumbers",render:(o,n)=>o.map(i=>e.jsx("section",{className:"room",children:e.jsxs(X,{value:`${i._id}_${n.price*(t==null?void 0:t.days)}_${i.number}`,onChange:z,children:[" ",i.number]})}))}];return e.jsx("section",{children:e.jsx(Z,{locale:S.language==="vi_VN"&&O,children:e.jsxs(L,{className:"departhtLayout",children:[e.jsxs(se,{children:[e.jsx(J,{}),e.jsx(Q,{})]}),e.jsx(ne,{children:e.jsx("section",{className:"grooming-page",children:e.jsx("section",{className:"grooming-page_containner",children:e.jsxs("section",{className:"grooming-listroom",children:[e.jsx("section",{className:"grooming-breadcum",children:e.jsxs(d,{separator:">",children:[e.jsx(d.Item,{children:e.jsx(I,{to:"/",children:s("home")})}),e.jsx(d.Item,{children:e.jsx(I,{to:-1,children:s("list search")})}),e.jsx(d.Item,{children:s("result")})]})}),e.jsxs("section",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h2",{style:{fontWeight:700,textTransform:"capitalize",fontSize:30},children:s("availability")}),e.jsx("section",{style:{display:"flex",justifyContent:"center",gap:15,alignItems:"center",fontWeight:700},children:e.jsx(h,{style:{marginInline:15},type:"primary",disabled:!t.datesGrooming||c.length<=0,onClick:()=>g(!0),children:s("Make an appointment")})})]}),e.jsx(ee,{title:s("Confirm Booking"),centered:!0,open:B,footer:null,onCancel:()=>g(!1),children:e.jsxs(r,{colon:!1,form:P,name:"horizontal_appointment",layout:"horizontal",initialValues:{},onFinish:Y,requiredMark:!1,children:[e.jsx(r.Item,{rules:[{required:!0,message:s("Please input name!")}],name:"name",children:e.jsx(u,{placeholder:s("Name")})}),e.jsx(r.Item,{rules:[{required:!0,message:s("Please input email!")}],name:"email",label:e.jsx(RiMailSendLine,{}),children:e.jsx(u,{placeholder:s("Email")})}),e.jsx(r.Item,{rules:[{required:!0,message:s("Please input phone number!")}],name:"phone",label:e.jsx(RiPhoneLine,{}),children:e.jsx(u,{placeholder:s("Phone Number")})}),e.jsxs(r.Item,{style:{display:"flex",justifyContent:"flex-end",marginBlock:"5px -5px"},children:[e.jsx(h,{style:{marginInline:"0px 15px",height:"fit-content",fontSize:16,lineHeight:1.8,borderRadius:5},type:"text",onClick:()=>g(!1),children:s("Close")}),e.jsx(h,{style:{height:"fit-content",fontSize:16,lineHeight:1.8,borderRadius:5,boxShadow:"rgb(0 0 0 / 25%) 0px 2px 4px 0px"},type:"primary",htmlType:"submit",children:s("Confirm")})]})]})}),e.jsxs("section",{className:"grooming-page_roomcontent",children:[e.jsx(r,{form:F,requiredMark:!1,name:"form_bookingdepartpage",layout:"horizontal",initialValues:{datesGrooming:(t==null?void 0:t.datesGrooming)&&moment(t==null?void 0:t.datesGrooming)},onValuesChange:V,children:e.jsx(r.Item,{name:"datesGrooming",label:s("Booking time"),children:e.jsx(w,{defaultValue:(t==null?void 0:t.datesGrooming)&&moment(t==null?void 0:t.datesGrooming),showTime:{format:"HH:mm"},placement:"bottomLeft",format:S.language==="vi_VN"?"HH:mm, DD-MM-YYYY":"HH:mm, YYYY-MM-DD "})})})," ",e.jsx(k,{style:{backgroundColor:"white",padding:20,marginBlock:10,borderRadius:15,boxShadow:"rgb(153 196 227 / 25%) 0px 2px 8px"},scroll:{x:800},pagination:!1,columns:$,dataSource:j,loading:_})]})]})})})}),e.jsx(ae,{children:e.jsx(K,{})})]})})})}export{$e as default};
